{% extends 'profile/base_profile.html' %}
{% comment %}
# This file is part of OpenHatch.
# Copyright (C) 2010 Parker Phinney
# Copyright (C) 2009 Karen Rustad
# Copyright (C) 2009, 2010 OpenHatch, Inc.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% load base_extras %}
{% load profile_extras %}

{% block title %}
{{ person.get_full_name_or_username }}
{% endblock title %}

{% block body_class %}{{ block.super }} view_mode{% endblock body_class %}

{% block main %}
<div class="module project-display viewer" id="missions">
    <div class="module-head">
        <h3>Missions</h3>
    </div>
    <div class="module-body">
        {% if nudge_missions %}
        <h5>Start learning:</h5>
        <p>
            Try our friendly, interactive training missions that teach you essential open source tools like diff and subversion.
        </p>
        {% else %}
          {% if completed_missions %}
        <ul class="missions">
            {% if completed_missions.tar or completed_missions.tar_extract %}
              {% if completed_missions.tar and completed_missions.tar_extract %}
            <li class="tick-progress">
                You have completed the
                <a href="{% url mysite.missions.tar.views.about %}">Tar mission.</a>
            </li>
            {% else %}
            <li class="cross-progress">
                You have partially completed the
                <a href="{% url mysite.missions.tar.views.about %}">Tar mission.</a>
            </li>
            {% endif %}
            {% endif %}
            {% if completed_missions.diffpatch_diffsingle or completed_missions.diffpatch_patchsingle or completed_missions.diffpatch_diffrecursive or completed_missions.diffpatch_patchrecursive %}
              {% if completed_missions.diffpatch_diffsingle and completed_missions.diffpatch_patchsingle and completed_missions.diffpatch_diffrecursive and completed_missions.diffpatch_patchrecursive %}
            <li class="tick-progress">
                You have completed the
                <a href="{% url mysite.missions.diffpatch.views.about %}">Diff and Patch mission.</a>
            </li>
            {% else %}
            <li class="cross-progress">
                You have partially completed this
                <a href="{% url mysite.missions.diffpatch.views.about %}">Diff and Patch mission.</a>
            </li>
            {% endif %}
            {% endif %}
            {% if completed_missions.svn_checkout or completed_missions.svn_diff or completed_missions.svn_commit %}
              {% if completed_missions.svn_checkout and completed_missions.svn_diff and completed_missions.svn_commit %}
            <li class="tick-progress">
                You have completed the
                <a href="{% url mysite.missions.svn.views.main_page %}">SVN mission.</a>
            </li>
            {% else %}
            <li class="cross-progress">
                You have partially completed the
                <a href="{% url mysite.missions.svn.views.main_page %}">SVN mission.</a>
            </li>
            {% endif %}
            {% endif %}
            {% if completed_missions.git_checkout or completed_missions.git_diff or completed_missions.git_rebase%}
              {% if completed_missions.git_checkout and completed_missions.git_diff and completed_missions.git_rebase%}
            <li class="tick-progress">
                You have completed the
                <a href="{% url mysite.missions.git.views.long_description %}">Git mission.</a>
            </li>
            {% else %}
            <li class="cross-progress">
                You have partially completed the
                <a href="{% url mysite.missions.git.views.long_description %}">Git mission.</a>
            </li>
            {% endif %}
            {% endif %}
        </ul>
        {% else %}
        <p>You haven't completed any missions yet.</p>
        {% endif %}
          {% endif %}
    </div>
    <div class="module-foot">
        <a href="{% url mysite.missions.base.views.main_page %}" class="module-foot-left">More missions &raquo;</a>
        &nbsp;
        <!---<a href="">Write a mission &raquo;</a>
    -->
    </div>
</div>

<div id='portfolio' class='module project-display viewer'>
    <div class='module-head'>
        <ul>
            <li>
                {% if editable %}
                    <a class='add-edit-projects' href=
                    '{% url "mysite.profile.views.portfolio_editor" %}'>Add/edit &raquo;
                    </a>
                {% endif %}
            </li>
        </ul>
        <h3>Projects</h3>
    </div>
        <div class='module-body'>
        {% with person.get_published_portfolio_entries as portfolio_entries %} 
            {% if portfolio_entries %}
                <ul>
                    {% for pf_entry in portfolio_entries %}
                    {% include 'profile/portfolio/portfolio_entry_element.html' %}
                    {% endfor %}
                </ul>
                {% if how_many_archived_pf_entries %}
                    <a id='show_more_projects' href='#'>
                        And {{ how_many_archived_pf_entries }} more&hellip;</a>
                    <noscript>
                        Enable JavaScript to see more stuff here.
                    </noscript>
                {% endif %}
            {% else %}
                {% if editable %}
                {# YOUR profile lacks projects. #}
                <ul class='nudgebuttons' style="float: left; padding-bottom: 10px;border-bottom: 2px dashed #ccc; margin-bottom: 10px;">

                    <li>
                    <a href='{% url "mysite.search.views.search_index" %}'>
                        <div class='notification'>
                            <div class='arrow' style=''>&raquo; <!--&#9654;--></div>
                            <strong>
                                Find a project to work on
                            </strong>
                            <span>
                                Looking for something to put here? No problem! Get started by searching our database of bite-sized bugs...
                            </span>
                        </div>
                    </a>
                    </li>

                    <li>
                    <a href='{% url "mysite.profile.views.portfolio_editor" %}'>
                        <div class='notification'>
                            <div class='arrow' style=''>&raquo; <!--&#9654;--></div>
                            <strong>
                                Add your contributions
                            </strong>
                            <span>
                                If you've contributed to open source already, say so on our project editor!
                                We want you to share your bug reports, translations, patches, community management, and code commits.
                            </span>
                        </div>
                    </a>
                    </li>

                    <li>
                    <a href='{% url "mysite.customs.views.list_trackers" %}'>
                        <div class='notification'>
				<div class='arrow' style=''>&raquo; <!--&#9654;--></div>
                            <strong>
                                Add your project's bugs
                            </strong>
                            <span>
                                If you are looking to list a project on Open Hatch for other contributors to find and submit patches to, add the project, add a bug tracker, and configure your project settings so others can find it.
                            </span>
                        </div>
                    </a>
                    </li>

                </ul>

                {# To find things to do in the open source community, use our volunteer opportunity finder.   #}
                {# <a href='{% url "mysite.search.views.search_index" %}'>find a bug to work on</a>. <a href='{% url "mysite.search.views.search_index" %}'>find someone near you to work with</a>#}

                {% endif %}
                <small style='color: #777; float: left; width: 100%;'>Nothing listed yet.</small>
            {% endif %}
        {% endwith %}

    </div>
    <div class="module-foot">
        {% if editable and person.get_published_portfolio_entries %}
        <ul>
            <li>
            <a href='{% url "mysite.search.views.search_index" %}'>
                Find a project &raquo;
            </a>
            </li>
            <li>
            <a href='{% url "mysite.customs.views.list_trackers" %}'>
                Add project's bugs &raquo;
            </a>
            </li>
        </ul>
        {% endif %}
    </div>
</div> <!-- /#portfolio -->


<!-- /# Activity Feed -->
<div class="module project-display viewer" id="projects">
      <div class="module-head">
        <h3>Activity Feed</h3>
      </div>
      <div class="module-body">
        <h5>I want to help with:</h5>
        {% if projects_i_wanna_help %}
          <ul class="raquo_bullets">
            {% for project in projects_i_wanna_help %}
              <li><a href='{{ project.get_url }}'>{{ project.display_name }}</a></li>
            {% endfor %}
          </ul>
          {% else %}
            <p>No projects listed yet.</p>
        {% endif %}

        <h5>I have helped:</h5>
          {% if projects_i_helped %}
          <ul class="raquo_bullets">
            {% for entry in projects_i_helped %}
              <li><a href="{{ entry.project.get_url }}">{{ entry.project.display_name }}</a></li>
            {% endfor %}
          </ul>
          {% else %}
            <p>No projects listed yet.</p>
          {% endif %}
        </div>
        <div class="module-foot"><a href='{% url mysite.search.views.search_index %}'>Find more projects to help with &raquo;</a></div>
          {% if settings.RECOMMEND_BUGS %}
        <div class="module-body">
      <h3>Recommended bugs based on your profile
        <a class="feed" href="/+feeds/recbugs/{{ user.username }}/"><img alt="Subscribe" src="{% version '/static/images/icons/feed-icon-14x14.png' %}" ></a>
      </h3>
      {% if recommended_bugs %}
        <div id="bugs">
          {% include "base/recommended_bugs_content.html" %}
        </div>
        {% else %}
        <div id='bug-recommendations' class='hidden'></div>
        <div id='volunteer-opportunities'>
          <p>There are currently no bug recommendations available.</p>
          {% if recommended_bug_string2Query_objects.items %}
            <p>You can always search for bugs manually. For example:</p>
            <ul>
              {% for string, query in recommended_bug_string2Query_objects.items %}
                {% with query.get_or_create_cached_hit_count as count %}
                  {% if count %}
                    {# Don't show an example if no volunteer opportunities match it. #}
                    <li><a href='/search?{{query.get_query_string}}'>{{string|safe}} ({{query.get_or_create_cached_hit_count}})</a></li>
                  {% endif %}
              {% endwith %}
            {% endfor %}
            {% comment %}
              {% for category in popular_bug_categories %}
                 <li><a href='{{ category.url }}'>{{ category.name }}</a></li>
              {% endfor %}
            {% endcomment %}
          </ul>
          {% endif %}
          {% endif %}
          </div>
          </div>
          <div class="module-foot"><a href='{% url mysite.search.views.search_index %}'>Find more recommendations and other opportunities &raquo;</a></div>
      {% endif %}
      </div>

{% endblock main %}

{% block js %}
    <script type='text/javascript'>
        $(ShowMoreProjects.init);
    </script>
{% endblock js %}
